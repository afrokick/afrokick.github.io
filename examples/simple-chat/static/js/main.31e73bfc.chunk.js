(window["webpackJsonppeerjs-examples-simple-chat"]=window["webpackJsonppeerjs-examples-simple-chat"]||[]).push([[0],{51:function(e,n,t){e.exports=t(63)},56:function(e,n,t){},57:function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=57},62:function(e,n,t){},63:function(e,n,t){"use strict";t.r(n);var a=t(0),o=t.n(a),c=t(7),r=t.n(c),i=(t(56),t(27)),s=t(20),l=t(38),m=t(39),u=t(44),d=t(11),g=t(41),p=t(106),f=t(108),h=t(102),E=t(94),b=t(98),C=t(99),v=t(100),k=t(109),I=t(96),w=t(97),x=Object(E.a)({orangeAvatar:{margin:5,color:"#fff",backgroundColor:I.a[500]},purpleAvatar:{margin:5,color:"#fff",backgroundColor:w.a[500]}}),y=function(e){var n=e.isLocal,t=e.nickname,a=x(),c=n?"Me":t;return o.a.createElement(b.a,{className:n?a.orangeAvatar:a.purpleAvatar},c)},S=function(e){var n=e.message,t=(e.classes,n.nickname),a=n.text,c=n.ts,r=n.isLocal;return o.a.createElement(C.a,{alignItems:"flex-start"},o.a.createElement(v.a,null,o.a.createElement(y,{isLocal:r,nickname:t})),o.a.createElement(k.a,{primary:a,secondary:o.a.createElement(o.a.Fragment,null,c.toLocaleString())}))},j=t(101),O=Object(E.a)(function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},inline:{display:"inline"}}}),D=function(e){var n=e.messages,t=O();return o.a.createElement(o.a.Fragment,null,o.a.createElement("h3",null,"Lets start conversation..."),o.a.createElement(j.a,{className:t.root},n.map(function(e){return o.a.createElement(S,{key:String(e.ts.getTime()),message:e,classes:t})})))},L=t(107),T=t(104),M=t(105),N=Object(E.a)(function(e){return{wrapper:{margin:e.spacing(1),padding:e.spacing(2),position:"relative"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginLeft:"-12px",marginTop:"-12px"}}}),A=function(e){var n=e.connected,t=e.connecting,a=e.myId,c=e.remoteId,r=e.onConnectClick,i=e.onMyIdChange,s=e.onRemoteIdChange,l=N();return o.a.createElement(h.a,null,o.a.createElement(f.a,{m:"5px"},o.a.createElement(L.a,{placeholder:"Your nickname",value:a,label:"Your nickname",required:!0,disabled:t||n,onChange:i}),o.a.createElement(L.a,{placeholder:"Remote nickname",value:c,label:"Remote nickname",required:!0,disabled:t||n,onChange:s})),!n&&o.a.createElement(f.a,{className:l.wrapper},o.a.createElement(T.a,{variant:"contained",onClick:r,disabled:t},"Connect"),t&&o.a.createElement(M.a,{size:24,className:l.buttonProgress})))},P=t(33),R=t(103),J=function(e){var n=e.onSendClick,t=Object(a.useState)(""),c=Object(P.a)(t,2),r=c[0],i=c[1];return o.a.createElement(R.a,{placeholder:"Enter text...",value:r,onChange:function(e){return i(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),n(r),i(""))}})},_=function e(n){var t=n.nickname,a=n.text,o=n.ts,c=n.isLocal;Object(i.a)(this,e),this.nickname=t,this.text=a,this.ts=o,this.isLocal=c},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return Object(d.a)(Array(e)).map(function(e){return(~~(36*Math.random())).toString(36)}).join("")},V=function(e){function n(e){var t;return Object(i.a)(this,n),(t=Object(l.a)(this,Object(m.a)(n).call(this,e))).onMyIdChange=function(e){var n=e.target;t.setState({myId:n.value})},t.onRemoteIdChange=function(e){var n=e.target;t.setState({remoteId:n.value})},t.onConnectClick=function(){console.log("start connecting..."),t.setState({connecting:!0}),t.peer=new g.peerjs.Peer(t.state.myId,{debug:3}),t.peer.on("open",t.onConnectedToPeerJS),t.peer.on("connection",t.onIncomingDataConnection)},t.onConnectedToPeerJS=function(){t.state.remoteId&&(t.dc=t.peer.connect(t.state.remoteId),t.subscribeToDCEvents())},t.subscribeToDCEvents=function(){t.dc.on("open",function(){console.log("DC opened!"),t.setState({connecting:!1,connected:!0})}),t.dc.on("close",function(){console.log("DC closed!")}),t.dc.on("data",function(e){console.log("DC data:".concat(e)),t.addMessage(new _({nickname:t.dc.peer,ts:new Date,text:e,isLocal:!1}))}),t.dc.on("error",function(e){console.error("DC error:".concat(e))})},t.onIncomingDataConnection=function(e){console.log("Incoming dc:",e),t.dc=e,t.setState({remoteId:e.peer}),t.subscribeToDCEvents()},t.onNewTextInputSend=function(e){t.addMessage(new _({nickname:t.state.myId,ts:new Date,text:e,isLocal:!0})),t.dc.send(e)},t.state={myId:"user_".concat(F()),remoteId:"",messages:[],connecting:!1,connected:!1,sending:!1},t.peer=null,t.dc=null,t}return Object(u.a)(n,e),Object(s.a)(n,[{key:"addMessage",value:function(e){this.setState({messages:[].concat(Object(d.a)(this.state.messages),[e])})}},{key:"render",value:function(){var e=this.state,n=e.myId,t=e.remoteId,a=e.connecting,c=e.connected,r=e.messages;return o.a.createElement(p.a,{maxWidth:"sm"},o.a.createElement(f.a,null,o.a.createElement(A,{myId:n,remoteId:t,connecting:a,connected:c,onConnectClick:this.onConnectClick,onMyIdChange:this.onMyIdChange,onRemoteIdChange:this.onRemoteIdChange})),c&&o.a.createElement(f.a,{marginTop:"10px"},o.a.createElement(h.a,null,o.a.createElement(f.a,{padding:"5px"},o.a.createElement(D,{messages:r})),o.a.createElement(f.a,{padding:"5px"},o.a.createElement(J,{onSendClick:this.onNewTextInputSend})))))}}]),n}(o.a.Component),q=(t(62),function(e){var n=e.repoLink;return o.a.createElement("p",null,"View Source on ",o.a.createElement("a",{href:n,title:"View Source on GitHub",target:"_blank",rel:"noopener noreferrer"},o.a.createElement("img",{height:"24",width:"24",src:"https://unpkg.com/simple-icons@latest/icons/github.svg",alt:"View Source on GitHub"})))});r.a.render(o.a.createElement(function(){return o.a.createElement("div",{className:"App"},o.a.createElement(V,null),o.a.createElement(q,{repoLink:"https://github.com/afrokick/peerjs-examples/tree/master/simple-chat"}))},null),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.31e73bfc.chunk.js.map