{"version":3,"sources":["../node_modules/peerjs/dist sync","components/message.jsx","components/messages.jsx","components/connect.jsx","components/input.jsx","models/message.js","components/chat.jsx","components/viewSource.jsx","index.js","App.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","useStyles","makeStyles","orangeAvatar","margin","color","backgroundColor","deepOrange","purpleAvatar","deepPurple","UserAvatar","isLocal","nickname","classes","name","Avatar","className","Message","message","text","ts","ListItem","alignItems","ListItemAvatar","ListItemText","primary","secondary","toLocaleString","theme","root","width","maxWidth","palette","background","paper","inline","display","Messages","messages","List","map","key","String","getTime","wrapper","spacing","padding","position","buttonProgress","top","left","marginLeft","marginTop","Connect","connected","connecting","myId","remoteId","onConnectClick","onMyIdChange","onRemoteIdChange","Paper","Box","m","TextField","placeholder","value","label","required","disabled","onChange","Button","variant","onClick","CircularProgress","size","NewMessageInput","onFileSelected","accept","style","type","ev","target","files","file","htmlFor","component","this","getRandomNumber","length","Array","i","Math","random","toString","join","saveByteArray","a","document","createElement","body","appendChild","data","blob","Blob","url","window","URL","createObjectURL","href","download","click","revokeObjectURL","Chat","props","setState","console","log","peer","peerjs","Peer","state","debug","on","onConnectedToPeerJS","onIncomingDataConnection","pc","dc","connect","reliable","subscribeToDCEvents","addMessage","Date","sampleBytes","error","setTimeout","send","sending","Container","React","Component","ViewSource","repoLink","title","rel","height","src","alt","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.f7f18945.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 53;","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Avatar, ListItem, ListItemAvatar, ListItemText } from '@material-ui/core/';\nimport { deepOrange, deepPurple } from '@material-ui/core/colors';\n\nconst useStyles = makeStyles({\n    orangeAvatar: {\n        margin: 5,\n        color: '#fff',\n        backgroundColor: deepOrange[500],\n    },\n    purpleAvatar: {\n        margin: 5,\n        color: '#fff',\n        backgroundColor: deepPurple[500],\n    },\n});\n\nconst UserAvatar = ({ isLocal, nickname }) => {\n    const classes = useStyles();\n    const name = isLocal ? 'Me' : nickname;\n\n    return (\n        <Avatar className={isLocal ? classes.orangeAvatar : classes.purpleAvatar}>{name}</Avatar>\n\n    );\n};\n\nexport const Message = ({ message, classes }) => {\n    const { nickname, text, ts, isLocal } = message;\n\n    return (\n        <ListItem alignItems=\"flex-start\">\n            <ListItemAvatar>\n                <UserAvatar isLocal={isLocal} nickname={nickname} />\n            </ListItemAvatar>\n            <ListItemText\n                primary={text}\n                secondary={<>{ts.toLocaleString()}</>}\n            />\n        </ListItem>\n    )\n}","import React from 'react';\nimport { Message } from './message';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { List } from '@material-ui/core';\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        width: '100%',\n        maxWidth: 360,\n        backgroundColor: theme.palette.background.paper,\n    },\n    inline: {\n        display: 'inline',\n    },\n}));\n\nexport const Messages = ({ messages }) => {\n    const classes = useStyles();\n\n    return (\n        <>\n            <h3>Lets sending files...</h3>\n            <List className={classes.root}>\n                {messages.map(message => {\n                    return <Message key={String(message.ts.getTime())} message={message} classes={classes} />\n                })}\n            </List>\n        </>)\n}","import React from 'react';\nimport { Box, TextField, Button, Paper, CircularProgress } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles(theme => ({\n    wrapper: {\n        margin: theme.spacing(1),\n        padding: theme.spacing(2),\n        position: 'relative',\n    },\n    buttonProgress: {\n        position: 'absolute',\n        top: '50%',\n        left: '50%',\n        marginLeft: '-12px',\n        marginTop: '-12px'\n    },\n}));\n\nexport const Connect = ({ connected, connecting, myId, remoteId, onConnectClick, onMyIdChange, onRemoteIdChange }) => {\n    const classes = useStyles();\n\n    return (\n        <Paper>\n            <Box m=\"5px\">\n                <TextField placeholder=\"Your nickname\" value={myId} label=\"Your nickname\" required disabled={connecting || connected} onChange={onMyIdChange} />\n                <TextField placeholder=\"Remote nickname\" value={remoteId} label=\"Remote nickname\" required disabled={connecting || connected} onChange={onRemoteIdChange} />\n            </Box>\n            {!connected && <Box className={classes.wrapper}>\n                <Button variant=\"contained\" onClick={onConnectClick} disabled={connecting}>Connect</Button>\n                {connecting && <CircularProgress size={24} className={classes.buttonProgress} />}\n            </Box>}\n        </Paper>\n    )\n}","import React from 'react';\nimport { Button } from '@material-ui/core';\n\nexport const NewMessageInput = ({ onFileSelected }) => {\n    const onChange = (ev) => {\n        const [file] = ev.target.files || [];\n\n        if (!file) return;\n\n        onFileSelected(file);\n    };\n\n    return (\n        <>\n            <input\n                accept=\"*/*\"\n                style={{ display: 'none' }}\n                id=\"raised-button-file\"\n                type=\"file\"\n                onChange={onChange}\n            />\n            <label htmlFor=\"raised-button-file\">\n                <Button variant=\"contained\" component=\"span\">Upload</Button>\n            </label>\n        </>\n    );\n}","export class Message {\n    constructor({ nickname, text, ts, isLocal }) {\n        this.nickname = nickname;\n        this.text = text;\n        this.ts = ts;\n        this.isLocal = isLocal;\n    }\n}","import React from 'react';\nimport { peerjs } from 'peerjs';\nimport { Box, Container, Paper } from '@material-ui/core';\nimport { Messages } from './messages';\nimport { Connect } from './connect';\nimport { NewMessageInput } from './input';\nimport { Message } from '../models/message';\n\nconst getRandomNumber = (length = 5) => [...Array(length)].map(i => (~~(Math.random() * 36)).toString(36)).join('');\n\nconst saveByteArray = (function () {\n    const a = document.createElement(\"a\");\n    document.body.appendChild(a);\n    a.style = \"display: none\";\n\n    return function (data, name) {\n        var blob = new Blob(data, { type: \"octet/stream\" }),\n            url = window.URL.createObjectURL(blob);\n        a.href = url;\n        a.download = name;\n        a.click();\n        window.URL.revokeObjectURL(url);\n    };\n}());\n\nexport class Chat extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            myId: `user_${getRandomNumber()}`,\n            remoteId: '',\n            messages: [],\n            connecting: false,\n            connected: false,\n            sending: false,\n        }\n\n        this.peer = null;\n        this.dc = null;\n    }\n\n    addMessage(message) {\n        this.setState({\n            messages: [...this.state.messages, message]\n        })\n    }\n\n    onMyIdChange = ({ target }) => {\n        this.setState({\n            myId: target.value\n        })\n    }\n\n    onRemoteIdChange = ({ target }) => {\n        this.setState({\n            remoteId: target.value,\n        })\n    }\n\n    onConnectClick = () => {\n        console.log('start connecting...');\n        this.setState({ connecting: true })\n\n        this.peer = new peerjs.Peer(this.state.myId, { debug: 3 });\n        this.peer.on('open', this.onConnectedToPeerJS);\n        this.peer.on('connection', this.onIncomingDataConnection);\n\n        window.pc = this.peer; //for test purpose\n    }\n\n    onConnectedToPeerJS = () => {\n        if (!this.state.remoteId) return;\n\n        this.dc = this.peer.connect(this.state.remoteId, { reliable: true });\n\n        this.subscribeToDCEvents();\n    }\n\n    subscribeToDCEvents = () => {\n        window.dc = this.dc; //for test purpose\n\n        this.dc.on('open', () => {\n            console.log(`DC opened!`);\n\n            this.setState({\n                connecting: false,\n                connected: true,\n            });\n        });\n        this.dc.on('close', () => {\n            console.log(`DC closed!`);\n        });\n        this.dc.on('data', (data) => {\n            console.log(`DC data:`, data);\n\n            if (!data || !data.name) return;\n\n            this.addMessage(new Message({\n                nickname: this.dc.peer,\n                ts: new Date(),\n                text: `file ${data.name} received`,\n                isLocal: false,\n            }));\n\n            const sampleBytes = data.file;\n\n            saveByteArray([sampleBytes], data.name);\n        });\n        this.dc.on('error', (error) => {\n            console.error(`DC error:${error}`);\n        });\n    }\n\n    onIncomingDataConnection = (dc) => {\n        console.log(`Incoming dc:`, dc);\n\n        this.dc = dc;\n\n        this.setState({\n            remoteId: dc.peer,\n        })\n\n        this.subscribeToDCEvents();\n    }\n\n    onFileSelected = (file) => {\n        console.log(file);\n        this.addMessage(new Message({\n            nickname: this.state.myId,\n            ts: new Date(),\n            text: `file ${file.name} was send`,\n            isLocal: true,\n        }));\n\n        setTimeout(() => {\n            console.log(`start sending...`);\n            this.dc.send({ file, name: file.name });\n        }, 500);\n    }\n\n    render() {\n        const { myId, remoteId, connecting, connected, messages } = this.state;\n\n        return <Container maxWidth=\"sm\">\n            <Box>\n                <Connect\n                    myId={myId}\n                    remoteId={remoteId}\n                    connecting={connecting}\n                    connected={connected}\n                    onConnectClick={this.onConnectClick}\n                    onMyIdChange={this.onMyIdChange}\n                    onRemoteIdChange={this.onRemoteIdChange} />\n            </Box>\n            {connected && (<Box marginTop=\"10px\">\n                <Paper>\n                    <Box padding=\"5px\">\n                        <Messages messages={messages} />\n                    </Box>\n                    <Box padding=\"5px\">\n                        <NewMessageInput onFileSelected={this.onFileSelected} />\n                    </Box>\n                </Paper>\n            </Box>)}\n        </Container>\n    }\n}","import React from 'react';\n\nexport const ViewSource = ({ repoLink }) => {\n  return (\n    <p>View Source on <a href={repoLink} title=\"View Source on GitHub\" target=\"_blank\" rel=\"noopener noreferrer\"><img height=\"24\" width=\"24\" src=\"https://unpkg.com/simple-icons@latest/icons/github.svg\" alt=\"View Source on GitHub\" /></a></p>\n  )\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { App } from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","import React from 'react';\nimport { Chat } from './components/chat';\nimport './App.css';\nimport { ViewSource } from './components/viewSource';\n\nexport function App() {\n  return (\n    <div className=\"App\">\n      <Chat />\n      <ViewSource repoLink=\"https://github.com/afrokick/peerjs-examples/tree/master/file-transfering\" />\n    </div>\n  );\n}\n"],"sourceRoot":""}